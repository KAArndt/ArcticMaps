<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="initial-scale=1,maximum-scale=1,user-scalable=no"
    />
    <title>
      Tower Sites PP Colors
    </title>

    <style>
      html,
      body,
      #viewDiv {
        padding: 0;
        margin: 0;
        height: 100%;
        width: 100%;
      }
    </style>

    <link
      rel="stylesheet"
      href="https://js.arcgis.com/4.23/esri/themes/light/main.css"
    />
    <script src="https://js.arcgis.com/4.23/"></script>

    <script>
      require([
        "esri/Map",
        "esri/layers/CSVLayer",
        "esri/views/MapView",
        "esri/layers/VectorTileLayer",
        "esri/layers/TileLayer"
      ], (Map, CSVLayer, MapView, VectorTileLayer, TileLayer) => {

        const template = {
          title: "Tower Information",
          content:
            "<p><b>Name:</b> {Site_Name}</p>" +
            "<p><b>Site_ID:</b> {Site_ID}</p>" +
            "<p><b>Contact:</b> {Contact}</p>" +
            "<p><b>Biome:</b> {Biome}</p>" +
            "<p><b>Data Access:</b> <a href={Data}>{Data}</a></p>"
        };


        const csvRenderer = {
          type: "simple", // autocasts as new SimpleRenderer()
          style: "circle",
          symbol: {
            type: "simple-marker", // autocasts as new SimpleMarkerSymbol()
            size: 10,
            color: "#2253ff",
            outline: { style: "dash", join: "round", width: 1.0, color: [31, 38, 36, 0.5] }
          }
        };



        const csvLayer = new CSVLayer({
          url: "https://gfiske.github.io/ArcticMaps/tower_sites_annual_co2_CH4.csv",
          popupTemplate: template,
          copyright: "sites",
          renderer: csvRenderer
        });

        // Multiply blend mode emphasizes the darkest parts of overlapping layers
        // by multiplying colors of the top layer and the background layer.
        // This blend mode is useful to have the hillshades to show through the top layer.
        const map = new Map({
          basemap: {
            baseLayers: [
              new TileLayer({
                portalItem: {
                  id: "1b243539f4514b6ba35e7d995890db1d" // world hillshade
                }
              }),
              new VectorTileLayer({
                portalItem: {
                  id: "06b93ca75bcc45b9a69fb5d262aaad8c" // community style vector tiles
                },
                blendMode: "multiply"
              })
            ]
          },
          layers: [csvLayer]
        });
        //map.add(csvLayer); // adds the layer to the map

        const view = new MapView({
          container: "viewDiv",
          map: map,
          zoom: 5,
          center: [-155, 65.733]
        });
      });
    </script>
  </head>
  <body>
    <div id="viewDiv"></div>
  </body>
</html>
